<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>02. Nachbauanleitung - WordClockanazier | Sketching with Hardware I + II</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Eine WordClock ist eine Uhr, die anstelle von Zahlen Wörter oder Buchstaben verwendet, um die Uhrzeit anzuzeigen. Indem die WordClock mit einem intelligenten Kalender verknüpft wird, hilft sie dabei die Uhrzeit im Blick zu behalten und gleichzeitig über anstehende Termine informiert zu sein. Daneben bietet der &ldquo;WordClockanazier&rdquo; weitere Features wie einen Farbwechselbutton, ein Ambient-Light und eine automatische Helligkeitsanpassung. Einzelne Komponenten wie das Ambient-Light oder der Kalender können zudem beliebig ein- und ausgeschaltet werden."><meta name=generator content="Hugo 0.115.4"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/swh/ananke/css/main.min.css><link rel="shortcut icon" href=/swh/pictures/icon.PNG type=image/x-icon><meta property="og:title" content="02. Nachbauanleitung - WordClockanazier"><meta property="og:description" content="Eine WordClock ist eine Uhr, die anstelle von Zahlen Wörter oder Buchstaben verwendet, um die Uhrzeit anzuzeigen. Indem die WordClock mit einem intelligenten Kalender verknüpft wird, hilft sie dabei die Uhrzeit im Blick zu behalten und gleichzeitig über anstehende Termine informiert zu sein. Daneben bietet der &ldquo;WordClockanazier&rdquo; weitere Features wie einen Farbwechselbutton, ein Ambient-Light und eine automatische Helligkeitsanpassung. Einzelne Komponenten wie das Ambient-Light oder der Kalender können zudem beliebig ein- und ausgeschaltet werden."><meta property="og:type" content="article"><meta property="og:url" content="https://manueladragic.github.io/swh/posts/post9/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-24T00:08:16+02:00"><meta property="article:modified_time" content="2023-07-24T00:08:16+02:00"><meta itemprop=name content="02. Nachbauanleitung - WordClockanazier"><meta itemprop=description content="Eine WordClock ist eine Uhr, die anstelle von Zahlen Wörter oder Buchstaben verwendet, um die Uhrzeit anzuzeigen. Indem die WordClock mit einem intelligenten Kalender verknüpft wird, hilft sie dabei die Uhrzeit im Blick zu behalten und gleichzeitig über anstehende Termine informiert zu sein. Daneben bietet der &ldquo;WordClockanazier&rdquo; weitere Features wie einen Farbwechselbutton, ein Ambient-Light und eine automatische Helligkeitsanpassung. Einzelne Komponenten wie das Ambient-Light oder der Kalender können zudem beliebig ein- und ausgeschaltet werden."><meta itemprop=datePublished content="2023-07-24T00:08:16+02:00"><meta itemprop=dateModified content="2023-07-24T00:08:16+02:00"><meta itemprop=wordCount content="4741"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="02. Nachbauanleitung - WordClockanazier"><meta name=twitter:description content="Eine WordClock ist eine Uhr, die anstelle von Zahlen Wörter oder Buchstaben verwendet, um die Uhrzeit anzuzeigen. Indem die WordClock mit einem intelligenten Kalender verknüpft wird, hilft sie dabei die Uhrzeit im Blick zu behalten und gleichzeitig über anstehende Termine informiert zu sein. Daneben bietet der &ldquo;WordClockanazier&rdquo; weitere Features wie einen Farbwechselbutton, ein Ambient-Light und eine automatische Helligkeitsanpassung. Einzelne Komponenten wie das Ambient-Light oder der Kalender können zudem beliebig ein- und ausgeschaltet werden."></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://manueladragic.github.io/swh/pictures/wordclock.jpeg)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/swh/ class="f3 fw2 hover-white no-underline white-90 dib"><img src=/swh/pictures/logo_weiss.png class="w100 mw5-ns" alt="Sketching with Hardware I + II"></a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"><div class="f2 f1-l fw2 white-90 mb0 lh-title">02. Nachbauanleitung - WordClockanazier</div></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">02. Nachbauanleitung - WordClockanazier</h1><p class=tracked>By <strong>Manuela Dragic</strong></p><time class="f6 mv4 dib tracked" datetime=2023-07-24T00:08:16+02:00>July 24, 2023</time>
<span class="f6 mv4 dib tracked">- 23 minutes read</span>
<span class="f6 mv4 dib tracked">- 4741 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Eine WordClock ist eine Uhr, die anstelle von Zahlen Wörter oder Buchstaben verwendet, um die Uhrzeit anzuzeigen.
Indem die WordClock mit einem intelligenten Kalender verknüpft wird, hilft sie dabei die Uhrzeit im Blick zu behalten und gleichzeitig über anstehende Termine informiert zu sein.
Daneben bietet der &ldquo;WordClockanazier&rdquo; weitere Features wie einen Farbwechselbutton, ein Ambient-Light und eine automatische Helligkeitsanpassung.
Einzelne Komponenten wie das Ambient-Light oder der Kalender können zudem beliebig ein- und ausgeschaltet werden.
Betrieben wird die Uhr mit einem 5V Netzteil.</p><p>Die Kosten für das Projekt betragen etwa 50 Euro.</p><p><figure><img src=../pictures/Wordclock.jpeg width=60% height=60%></figure><figure><img src=../pictures/Rahmen_oben%28neu%29.jpeg width=60% height=60%></figure><figure><img src=../pictures/Rahmen_rechts%28neu%29.jpeg width=60% height=60%></figure><figure><img src=../pictures/Rahmen_links%28neu%29.jpeg width=60% height=60%></figure><video width=60% controls autoplay>
<source src=../pictures/Funktionen.mp4 type=video/mp4>Your browser does not support the video tag.</video></p></br><h3 id=bauteile-zubehör-und-benötigte-programme>Bauteile, Zubehör und benötigte Programme</h3><h4 id=technik>Technik:</h4><ul><li><input disabled type=checkbox> Wemos D1 mini</li><li><input disabled type=checkbox> RTC Modul</li><li><input disabled type=checkbox> Knopf Batterie (für RTC Modul)</li><li><input disabled type=checkbox> 3m LED Stripe (60 LEDs pro Meter)</li><li><input disabled type=checkbox> 3x 4in1 Led Matrizen</li><li><input disabled type=checkbox> USB auf Mikro USB Kabel (zum uploaden des Codes)</li></ul><h4 id=materialien>Materialien:</h4><ul><li><input disabled type=checkbox> Verschiedene Kabel (rot, schwarz, lila, blau, gelb, grün, braun)</li><li><input disabled type=checkbox> Schrumpfschläuche</li><li><input disabled type=checkbox> 3x Platine 2x8cm</li><li><input disabled type=checkbox> 1x Platine 6x8cm</li><li><input disabled type=checkbox> 3x Button groß (1cm x 1cm)</li><li><input disabled type=checkbox> 3x Buttonkappe (schwarz)</li><li><input disabled type=checkbox> Helligkeitssensor</li><li><input disabled type=checkbox> 2x Diode</li><li><input disabled type=checkbox> 1x Widerstand 2,2kOhm</li><li><input disabled type=checkbox> 1x Widerstand 4,7 kOhm</li><li><input disabled type=checkbox> 2x Widerstand 470 Ohm</li><li><input disabled type=checkbox> 1x ON/OFF Kippschalter</li><li><input disabled type=checkbox> 5V Adapter</li><li><input disabled type=checkbox> 5V 3A Netzteil</li><li><input disabled type=checkbox> 4 Senkkopfschrauben (3mm Durchmesser, 12mm lang)</li><li><input disabled type=checkbox> 4 Schrauben Fassungen (3mm Durchmesser, 5mm lang)</li></ul><figure><img src=../pictures/bauteile.jpeg width=100% height=80%></figure><h4 id=sonstiges>Sonstiges:</h4><ul><li><input disabled type=checkbox> 2 x 3 mm dicke Spanplatte (mindestens 30x30cm groß)</li><li><input disabled type=checkbox> Durchsichtiges Filament (PLA)</li><li><input disabled type=checkbox> Schwarzes Filament (PLA)</li><li><input disabled type=checkbox> Doppelseitiges Klebeband</li><li><input disabled type=checkbox> 2 Komponenten Kleber</li></ul><h4 id=geräte>Geräte:</h4><ul><li><input disabled type=checkbox> großer 3D Drucker</li><li><input disabled type=checkbox> Lasercutter</li><li><input disabled type=checkbox> Lötkolben und -zubehör</li><li><input disabled type=checkbox> Bandsäge, Stichsäge oder eine andere Säge</li><li><input disabled type=checkbox> kleiner Schraubenzieher</li></ul><h4 id=programme>Programme:</h4><ul><li><input disabled type=checkbox> Arduino IDE</li><li><input disabled type=checkbox> Lightburn</li><li><input disabled type=checkbox> (Fusion 360)</li><li><input disabled type=checkbox> (UltiMaker Cura)</li></ul><h4 id=bauteile-zu-cutten>Bauteile zu Cutten:</h4><ul><li><input disabled type=checkbox> Buchstabenplatte (3mm Spanplatte)</li><li><input disabled type=checkbox> LED Halterung (3mm Spanplatte)</li><li><input disabled type=checkbox> Holzfurnier (Buche)</li></ul><h4 id=bauteile-zu-drucken>Bauteile zu Drucken:</h4><ul><li><input disabled type=checkbox> Matrizenhalterung (Schwarz)</li><li><input disabled type=checkbox> Rahmen (Schwarz)</li><li><input disabled type=checkbox> Raster (Schwarz)</li><li><input disabled type=checkbox> Rasterfüllung (Durchsichtig)</li><li><input disabled type=checkbox> Rückplatte (Durchsichtig)</li></ul><h4 id=zum-testen>Zum testen:</h4><ul><li><input disabled type=checkbox> Steckplatine</li><li><input disabled type=checkbox> Jumperkabel</li></ul></br><h3 id=dateien-zum-download>Dateien zum Download</h3><h4 id=3d-modelle-stls>3D-Modelle (STL&rsquo;s):</h4><ul><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/Matrizenhalterung.stl download>Matrizenhalterung</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/Word%20Clock%20Rahmen.stl download>Rahmen</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Raster.stl download>Raster</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Rasterfüllung.stl download>Rasterfüllung</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Rueckplatte.stl download>Rückplatte</a></li></ul><h4 id=fusion360-dateien>Fusion360 Dateien:</h4><ul><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/Matrizenhalterung.f3d download>Matrizenhalterung</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/Word%20Clock%20Rahmen.f3d download>Rahmen</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Raster.f3d download>Raster</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Rasterfüllung.f3d download>Rasterfüllung</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Rueckplatte.f3d download>Rückplatte</a></li></ul><h4 id=lightburn-datei>Lightburn Datei:</h4><ul><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/Lasercut.lbrn2 download>Lasercut</a></li></ul><h4 id=svg>SVG:</h4><ul><li><a href=https://github.com/ManuelaDragic/swh/blob/main/files/Lasercut.svg download>SVG Lasercut</a></li></ul><h4 id=code>Code:</h4><ul><li><a href=https://github.com/ManuelaDragic/swh/blob/main/code/Kalender.gs download>GoogleSkript</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/code/WordClock/WordClock.ino download>Arduino Code</a></li><li><a href=https://github.com/ManuelaDragic/swh/blob/main/code/WordClock/WordClockFont.h download>WordClock Font</a></li></ul><h4 id=links>Links:</h4><ul><li><a href=https://script.google.com download>Google Apps Skript</a></li><li><a href="https://workspace.google.com/products/calendar/?hl=de#" download>Google Kalender</a></li></ul></br><h3 id=lötplan>Lötplan</h3><figure><img src=../pictures/loetplan.jpg width=100% height=80%></figure></br><h3 id=schritt-für-schritt-bauanleitung>Schritt für Schritt Bauanleitung</h3><h4 id=1-drucken-der-bauteile>1. Drucken der Bauteile</h4><p>Zunächst einmal müssen die verschiedenen Bauteile gedruckt werden. Die zugehörigen STL&rsquo;s können auf meinem <a href=https://github.com/ManuelaDragic/swh/tree/main/files download>Github</a> heruntergeladen werden, sind oben aber nochmals verlinkt.
Wichtig ist, dass für den Rahmen und die Rückplatte ein großer Drucker benötigt wird, da die Bauteile später ca. 25x35cm groß werden.
(Ich verwendete dazu den Creality CR10S5).
Der <a href=https://github.com/ManuelaDragic/swh/blob/main/files/Word%20Clock%20Rahmen.stl download>Rahmen</a> des WordClockanizers, die <a href=https://github.com/ManuelaDragic/swh/blob/main/files/Matrizenhalterung.stl download>Matrizenhalterung</a> und das <a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Raster.f3d download>Raster</a> werden mit schwarzem PLA gedruckt. Für die <a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Rasterfüllung.f3d download>Rasterfüllung</a> und die <a href=https://github.com/ManuelaDragic/swh/blob/main/files/WordClock%20Rueckplatte.f3d download>Rückplatte</a> wird durchsichtiges PLA verwendet.
Falls die Modelle noch angepasst werden sollen, können die jeweiligen Fusion360 Dateien ebenfalls oben heruntergeladen werden.</p><p><figure><img src=../pictures/druck_schwarz.jpeg width=100% height=80%></figure><figure><img src=../pictures/druck_durchsichtig.jpeg width=100% height=80%></figure></p><h4 id=2-lasercutten>2. Lasercutten</h4><p>Danach werden die Buchstabenplatte und die LED-Stripe Halterung gecuttet. Dazu verwendete ich Lightburn. Zur leichteren Anpassung habe ich alle Linien des Cuts in eine <a href=https://github.com/ManuelaDragic/swh/blob/main/files/Lasercut.lbrn2 download>Datei</a> zusammengefügt. Für die Buchstabenplatte werden das innere Rechteck und die Buchstaben benötigt. Für die LED-Stripe Halterung werden das innere Rechteck und die schrägen Cuts an der linken und rechten Seite benötigt. Die jeweils anderen Linien können in Lightburn einfach ausgeblendet und ausgeschaltet werden.
Für die beiden Komponenten habe ich zwei 3mm dicke Spanplatten verwendet. Um sicher zu gehen sollten diese ca. 30x30cm groß sein.</p><p>Die Vorderseite der Wordclock besteht aus ca 0,4 mm dickem Holzfurnier. Dazu werden zunächst zwei DIN A4 große Furniere zusammengeklebt. Ich verwendete die Farbe Buche, es kann jedoch jedes beliebige, helle Holz oder sogar Papier verwendet werden.
Für die Vorderseite wird das äußere Rechteck und die Buchstaben benötigt.
Da das Furnier sehr dünn und spröde ist, muss sehr langsam und mit wenig Power gecuttet werden.
Testet eure Einstellungen zunächst am besten auf einem extra Furnier, indem ihr einen Buchstaben cuttet. So wisst ihr ob die Einstellungen die richtigen sind.</p><p><figure><img src=../pictures/buchstabenplatte.jpeg width=100% height=60%></figure><figure><img src=../pictures/furnier.jpeg width=100% height=60%></figure></p><h4 id=3-led-matrizen>3. LED Matrizen</h4><p>Anschließend nehmt ihr die LED-Matrizen zur Hand. Wir brauchen später 2 Reihem mit je 6 Matrizen, somit muss eine der 4er-Matrizen in zwei Hälften gecuttet werden. Dazu müssen die Matrizen einer 4er Reihe zunächst von der ihrer Platine genommen werden. Danach wird diese Platine in der Hälfte durgesägt. Ich habe dazu eine Bandsäge verwendet, ihr könnt jedoch auch eine andere Säge verwenden.
Die beiden Hälften müssen dann jeweils an die anderen beiden 4er Reihen gelötet werden. Dabei ist wichtig, dass die Richtung der Matrizen beachtet wird. Im Anschluss können die einzelnen Matrizen wieder aufgesteckt werden.
Ihr sollten nun 2 Reihen mit je 6 Matrizen haben.</p><h4 id=4-buchstabenplatte-und-raster>4. Buchstabenplatte und Raster</h4><p>Als nächstes muss der LED-Stripe auf die Platte gefädelt werden. Dies ist zwar mit etwas Arbeit verbunden, jedoch kann der Stripe so einfach ausgetauscht werden, falls er irgendwann kaputt gehen sollte. Zunächst muss der Stripe auf die richtige Länge geschnitten werden. Es werden genau 145 LED&rsquo;s benötigt. Wichtig ist dabei, dass die Richtung des Stripes beachtet wird und die hinteren LED&rsquo;s abgeschnitten werden, da der Stecker des Stripes noch benötigt wird.
Nach dem durchfädeln sollten in jeder Reihe 11 LED&rsquo;s nach vorne zeigen. An den Seiten zeigt nun immer eine LED nach hinten, diese wird später für das Ambient Light verwendet.</p><figure><img src=../pictures/led_halterung.jpeg width=100% height=60%></figure><p>Über die LED&rsquo;s wird dann das Raster gelegt. Damit nacher alles besser hält, habe ich doppelseitiges Klebeband verwendet, um die beiden Teile zusammen zu kleben. In die Löcher des Rasters werden dann die durchsichtigen Quadrate eingesetzt. Diese müssen nicht verklebt werden, da sie später zwischen den anderen beiden Platten eingeklemmt sind und somit nicht mehr verrutschen können, bei Bedarf können diese jedoch noch mit 2 Komponenten Kleber in das Raster geklebt werden.
Anschließend wird dann die gecuttete Buchstabenplatte, erneut mit doppelseitigem Klebeband, auf das Raster geklebt.</p><h4 id=5-verkabelung>5. Verkabelung</h4><p>Der nächste Schritt ist das Verkabeln der Komponenten.
Testet zunächst ob ihr alles richtig verkabelt habt, indem ihr Jumperkabel und eine Steckplatine verwendet. Dazu verwendet ihr folgenden Plan:<figure><img src=../pictures/loetplan.jpg width=100% height=80%></figure>Anbei ist noch einmal aufgelistet, welche PIN&rsquo;s der Komponenten mit den jeweiligen PIN&rsquo;s des ESP&rsquo;s verbunden werden:</p><h5 id=rtc-modul>RTC-Modul:</h5><p>SCL - D1</p><p>SDA - D2</p><p>VCC - 5V</p><p>GND - G</p><h5 id=led-stripe>LED-Stripe</h5><p>5V - 5V</p><p>DIN - D3</p><p>GND - G</p><h5 id=led-matrix-1>LED-Matrix 1</h5><p>CLK - D5</p><p>CS - D6</p><p>DATA - D7</p><p>GND - G</p><p>VCC - 5V</p><h5 id=led-matrix-2>LED-Matrix 2</h5><p>CLK - TX</p><p>CS - D4</p><p>DATA - D0</p><p>GND - G</p><p>VCC - 5V</p><h5 id=5v-adapter>5V Adapter</h5><p>GND - G</p><p>5V - 5V (mit zwischengeschaltetem Kippschalter)</p><p>Um die Kabel an den Adapter anzuschließen, schraubt ihr mit einem kleinen Schraubenzieher die Schrauben am Adapter ein wenig auf, steckt die Kabel rein und schraubt die Schrauben anschließend wieder gut zu.</p><h5 id=buttons-und-helligkeitssensor>Buttons und Helligkeitssensor</h5><p>Bei den Buttons ist wichtig, dass immer nur die zwei nebeneinanderliegenden oder die schräg-gegenüberliegenden Füßchen verwendet werden. Falls ihr euch nicht sicher seid, testet die Buttons zunächst mit einem Multimeter.</p><p>Der Button für den Farbwechsel befindet sich an einem seperaten Pin. Er wird an einer Seite an D8 am ESP angeschlossen, die andere Seite wird an VCC am ESP angeschlossen. Da dieser Button im Code entprellt wird, brauchen wir hierfür keinen Pulldown.</p><p>Die beiden anderen Buttons und der Helligkeitssensor werden an A0 angeschlossen. A0 ist der einzige analoge Pin an unserem ESP. Damit wir die verschiedenen Signale empfangen können, müssen wir vor die Buttons und vor den Helligkeitssensor verschiedene Widerstände schalten. Dadurch werden später beim analogRead im Code verschiedene Werte gelesen, wodurch unterschieden werden kann, ob sich die Helligkeit verändert hat oder ob ein Button, bzw. welcher Button gedrückt wurde.
Wichtig ist dabei, dass jeweils die richtigen Widerstände verwendet werden.
Während Widerstände und Helligkeitssensor keine Richtung haben, müsst ihr bei den Dioden beachten, dass ihr sie in die richtige Richtung anschließt.</p><h4 id=6-der-code>6. Der Code</h4><p>Der nächste Schritt ist das Programmieren. Dazu muss zunächst einmal die ArduinoIDE heruntergeladen werden.
Danach muss das Board installiert werden. Dazu geht ihr in die Preferences und fügt bei &ldquo;Additional boards manager URLs&rdquo; folgende Zeile ein:
<a href=http://arduino.esp8266.com/stable/package_esp8266com_index.json>http://arduino.esp8266.com/stable/package_esp8266com_index.json</a></p><figure><img src=../pictures/boardmanager.png width=100% height=100%></figure><p>Anschließend muss das richtige Board ausgewählt werden. Unser Board ist das Lolin Wemos D1 mini - Board.
Dazu geht ihr im Menü auf Tools > Board > ESP8266 > LOLIN WEMOS D1 R2 & mini.</p><figure><img src=../pictures/boardauswahl.png width=100% height=100%></figure><p>Danach verbindet ihr euren ESP mit einem USB Kabel an euren PC oder Laptop und wählt unter Port den entsprechenden USB Port aus.
Nun geht es an den Code des Wordclockanizers.
Der <a href=https://github.com/ManuelaDragic/swh/tree/main/code/WordClock download>Programmcode</a> kann ebenfalls einfach im GitHub-Repo heruntergeladen werden. Beachtet jedoch, dass ihr den Code und die Font im gleichen Ordner abspeichern müsst. Der Ordner muss den selben Namen wie unser Programmcode haben, in unserem Fall ist das &ldquo;WordClock&rdquo;.</p><h4 id=61-libraries>6.1 Libraries</h4><p>Für unser Programm müssen zunächst einige Libraries eingebunden werden.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;Wire.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;RTClib.h&gt;   </span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;FastLED.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;MD_Parola.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;MD_MAX72xx.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;SPI.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;Bounce2.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ESP8266WiFi.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ESP8266HTTPClient.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;Arduino.h&gt;</span><span style=color:#75715e>
</span></span></span></code></pre></div><p>Diese Libraries können einfach über den Library Manager in der Arduino IDE heruntergeladen werden. Sucht dazu einfach im Suchfeld nach den jeweiligen Namen.</p><figure><img src=../pictures/libraries.png width=100% height=100%></figure><p>Zudem werden hier die Fonts für die LED Matrizen eingebunden. Falls ihr später eigene Fonts einbinden möchtet, könnt ihr das an dieser Stelle tun.</p><h4 id=62-eigene-font-erstellen>6.2 Eigene Font erstellen</h4><p>Falls ihr später auf euren LED-Matrizen euren eigenen Font verwenden wollt, könnt ihr euch diesen einfach auf folgender Seite zusammenklicken:
<a href=https://pjrp.github.io/MDParolaFontEditor>https://pjrp.github.io/MDParolaFontEditor</a></p><p>Durch Auswahl der Quadrate können die Buchstaben dann einfach durch klicken der jeweiligen LED&rsquo;s erstellt werden.
Anschließend gebt ihr auf der linken Seite noch einen Namen für euren Font ein und exportiert dann alles.
Die fertige Datei legt ihr dann in den Ordner zu eurem Code.
Zuletzt muss die Datei dann nur noch im Arduino Code eingebunden werden.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&#34;Parola_Fonts_data.h&#34;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&#34;WordClockFont.h&#34;</span><span style=color:#75715e>
</span></span></span></code></pre></div><h4 id=63-wifi-connection>6.3 WIFI Connection</h4><p>Als nächstes müsst ihr im Code noch die WLAN Einstellungen anpassen.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> ssid <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;YOUR_SSID&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;YOUR_PASSWORD&#34;</span>;
</span></span></code></pre></div><p>YOUR_SSID muss natürlich mit dem Namen und YOUR_PASSWORD mit dem Passwort des eigenen WLANS ersetzt werden.</p><h4 id=64-kalenderdaten>6.4 Kalenderdaten</h4><h5 id=für-apple-kalender-user>Für Apple-Kalender User</h5><p>Da Apple das auslesen der Kalenderdaten nicht so einfach macht, müsst ihr hier etwas tricksen. Um später die eigenen Apple-Kalenderdaten anzeigen zu können, müsst ihr euern Apple Kalender von einem Google Kalender abonnieren.
Dazu muss man sich zunächst über einen Laptop oder PC mit seinem Google-Acoout beim <a href="https://workspace.google.com/products/calendar/?hl=de#" download>Google Kalender</a> anmelden.
Anschließend kann auf der linken Seite unter &ldquo;Weitere Kalender > + > Per URL&rdquo; ein Kalender abonniert werden.</p><figure><img src=../pictures/kalender_abonnieren.png width=100% height=100%></figure><p>Jetzt öffnet ihr auf eurem Handy euren Apple Kalender und klickt unten in der Mitte auf &ldquo;Kalender&rdquo;.
Dort wählt ihr den Kalender aus, den ihr teilen möchtet und klickt auf das i.
Der Kalender muss dann noch auf öffentlich gestellt werden. Unter &ldquo;Link teilen&rdquo; könnt ihr den Link anschließend kopieren und in das Feld &ldquo;URL des Kalenders&rdquo; im Google Kalender eintragen.
ACHTUNG! Das bedeutet, dass jetzt theoretisch jeder auf euren Kalender zugreifen kann.</p><p><figure><img src=../pictures/link.png width=60% height=60%></figure><figure><img src=../pictures/url.png width=100% height=100%></figure></p><h5 id=für-google-kalender-user>Für Google-Kalender User</h5><p>Falls ihr bereits einen Google-Kalender verwendet, könnt ihr diese Schritte natürlich überspringen.</p><p>Anschließend geht ihr auf <a href=https://script.google.com download>script.google.com</a> und meldet euch dort ebenfalls mit eurem Google Account an. Dort klickt ihr dann auf &ldquo;neues Projekt&rdquo;.</p><figure><img src=../pictures/neuesProjekt.png width=100% height=100%></figure><p>Gebt dem Projekt einen Namen und kopiert folgenden <a href=https://github.com/ManuelaDragic/swh/blob/main/code/Kalender.gs download>Code</a> hinein:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>doGet</span>(<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>calendars</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>getAllCalendars</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>calendars</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>undefined</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Logger</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;No data&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ContentService</span>.<span style=color:#a6e22e>createTextOutput</span>(<span style=color:#e6db74>&#34;no access to calendar&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>calendars_selected</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>calendars</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>calendars</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>isSelected</span>()) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>calendars_selected</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>calendars</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Logger</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>calendars</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>getName</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Logger</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Old: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>calendars</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; New: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>calendars_selected</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>now</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>start</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(); <span style=color:#a6e22e>start</span>.<span style=color:#a6e22e>setHours</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);      <span style=color:#75715e>// start at midnight
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>oneday</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>24</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3600000</span>;                            <span style=color:#75715e>// milliseconds
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>stop</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>start</span>.<span style=color:#a6e22e>getTime</span>() <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>oneday</span>);  <span style=color:#75715e>// appointments for the next 7 days
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>events</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mergeCalendarEvents</span>(<span style=color:#a6e22e>calendars_selected</span>, <span style=color:#a6e22e>start</span>, <span style=color:#a6e22e>stop</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>event</span><span style=color:#f92672>=</span><span style=color:#a6e22e>events</span>[<span style=color:#a6e22e>i</span>];    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>myStatus</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>getMyStatus</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span>(<span style=color:#a6e22e>myStatus</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>GuestStatus</span>.<span style=color:#a6e22e>OWNER</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>GuestStatus</span>.<span style=color:#a6e22e>YES</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>GuestStatus</span>.<span style=color:#a6e22e>NO</span><span style=color:#f92672>:</span>  
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>GuestStatus</span>.<span style=color:#a6e22e>INVITED</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>GuestStatus</span>.<span style=color:#a6e22e>MAYBE</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// format date and time output
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>options1</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>weekday</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;short&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>year</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;numeric&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>month</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;short&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>day</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;numeric&#34;</span>,
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>options2</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>hour</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;numeric&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>minute</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;numeric&#34;</span>,
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// create output string
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>str</span> <span style=color:#f92672>+=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>getStartTime</span>()).<span style=color:#a6e22e>toLocaleString</span>(<span style=color:#e6db74>&#34;de-DE&#34;</span>, <span style=color:#a6e22e>options1</span>) <span style=color:#f92672>+</span>  <span style=color:#e6db74>&#39; &#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>isAllDayEvent</span>()) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>str</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;(Ganztägig) &#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>str</span> <span style=color:#f92672>+=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>getStartTime</span>()).<span style=color:#a6e22e>toLocaleString</span>(<span style=color:#e6db74>&#34;de-DE&#34;</span>, <span style=color:#a6e22e>options2</span>) <span style=color:#f92672>+</span>  <span style=color:#e6db74>&#39;-&#39;</span> 
</span></span><span style=display:flex><span>      <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>getEndTime</span>()).<span style=color:#a6e22e>toLocaleString</span>(<span style=color:#e6db74>&#34;de-DE&#34;</span>, <span style=color:#a6e22e>options2</span>) <span style=color:#f92672>+</span>  <span style=color:#e6db74>&#39; &#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>str</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>getTitle</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; \n&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// replace vowels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/Ä/g</span>, <span style=color:#e6db74>&#34;AE&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/Ö/g</span>, <span style=color:#e6db74>&#34;OE&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/Ü/g</span>, <span style=color:#e6db74>&#34;UE&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/ä/g</span>, <span style=color:#e6db74>&#39;ae&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/ö/g</span>, <span style=color:#e6db74>&#39;oe&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/ü/g</span>, <span style=color:#e6db74>&#39;ue&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// return output String
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ContentService</span>.<span style=color:#a6e22e>createTextOutput</span>(<span style=color:#a6e22e>str</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>mergeCalendarEvents</span>(<span style=color:#a6e22e>calendars</span>, <span style=color:#a6e22e>startTime</span>, <span style=color:#a6e22e>endTime</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>start</span><span style=color:#f92672>:</span><span style=color:#a6e22e>startTime</span>, <span style=color:#a6e22e>end</span><span style=color:#f92672>:</span><span style=color:#a6e22e>endTime</span>, <span style=color:#a6e22e>uniqueIds</span><span style=color:#f92672>:</span>[] };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>calendars</span>.<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>toUniqueEvents_</span>, <span style=color:#a6e22e>params</span>)
</span></span><span style=display:flex><span>                  .<span style=color:#a6e22e>reduce</span>(<span style=color:#a6e22e>toSingleArray_</span>)
</span></span><span style=display:flex><span>                  .<span style=color:#a6e22e>sort</span>(<span style=color:#a6e22e>byStart_</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>toCalendars_</span>(<span style=color:#a6e22e>id</span>) { 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>getCalendarById</span>(<span style=color:#a6e22e>id</span>); 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>toUniqueEvents_</span> (<span style=color:#a6e22e>calendar</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>getEvents</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>start</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>end</span>)
</span></span><span style=display:flex><span>                 .<span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>onlyUniqueEvents_</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>uniqueIds</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>onlyUniqueEvents_</span>(<span style=color:#a6e22e>event</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>eventId</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>getId</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>uniqueEvent</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#a6e22e>eventId</span>) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>uniqueEvent</span>) <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>eventId</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>uniqueEvent</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>toSingleArray_</span>(<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) { 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>b</span>) 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>byStart_</span>(<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>getStartTime</span>().<span style=color:#a6e22e>getTime</span>() <span style=color:#f92672>-</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>getStartTime</span>().<span style=color:#a6e22e>getTime</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Speichert den Code ab und drückt dann auf &ldquo;Bereitstellen > Neue Bereitstellung&rdquo;</p><figure><img src=../pictures/bereitstellen.png width=100% height=100%></figure><p>Als Typ wählt ihr dann &ldquo;Web-App&rdquo; aus und bei Zugriffsrechte &ldquo;Jeder&rdquo;. Anschließend klickt ihr auf &ldquo;bereitstellen&rdquo;.
Jetzt erscheinen eine Bereitstellungs-ID und eine URL. Wenn ihr auf diese URL klickt und alles funktioniert hat, sollten nun eure Kalenderdaten der nächsten 7 Tage angezeigt werden.</p><figure><img src=../pictures/kalenderdaten_desktop.png width=100% height=100%></figure><p>Kopiert nun die URL und fügt sie im Arduino Code in die Methode &ldquo;getKalenderData()&rdquo; bei &ldquo;YOUR_URL&rdquo; ein:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>getKalenderData</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ... 
</span></span><span style=display:flex><span>  client.connect(<span style=color:#e6db74>&#34;script.googleusercontent.com&#34;</span>, <span style=color:#ae81ff>443</span>);
</span></span><span style=display:flex><span>  String url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;YOUR_URL&#34;</span>;
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=65-uhrzeit-des-rtc-moduls-stellen>6.5 Uhrzeit des RTC-Moduls stellen</h4><p>Als letzten Schritt müsst ihr jetzt noch die Uhrzeit eurer Uhr richtig stellen.
Dazu könnt ihr entweder die aktuelle Zeit über eure Konsole holen, oder manuell eine Uhrzeit angeben.
Falls ihr die erste Variante verwenden möchtet, dann verzögert sich eure Uhrzeit um die Länge des Uploads eures Codes, da die Zeit so auf die Zeit des Uploadbeginns gesetzt wird.
Verwendet ihr die zweite Variante, so müsst ihr den Code zunächst mit einer Zeit 2-3 Minuten im Voraus Uploaden, um dann zur genauen Zeit den reset Button an eurem ESP drücken zu können. Damit setzt ihr dann quasie &ldquo;zur richtigen Zeit&rdquo; eure eingegebene Uhrzeit.
Je nachdem welche Variante ihr verwendet, müsst ihr die jeweilige Zeile in der Methode &ldquo;setup()&rdquo; im Code einkommentieren.
Anschließend ladet ihr den Code dann ein zweites Mal hoch, dieses Mal jedoch wieder mit der auskommentierten Zeile, sodass eure Uhrzeit nicht jedes mal beim reset zurückgesetzt wird.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ----- RTC Modul -------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  rtc.begin();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Falls das DS3231-Modul nicht korrekt erkannt wird
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>rtc.begin()) {
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;Konnte RTC nicht finden!&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Falls das DS3231-Modul keine Stromversorgung hatte und dadurch die Zeit verloren hat, kann die Zeit hiermit festgelegt werden
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Beim ersten upload muss diese Zeile eingefügt werden
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Anschließend muss der Code nochmals mit auskommentierter Zeile geuploaded werden
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// rtc.adjust(DateTime(F(__DATE__), F(__TIME__)));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Oder die genaue Zeit kann hier im Format (JJJJ, MM, TT, hh, mm, ss) angegeben werden.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Wenn genau zu dieser Zeit reset am ESP gedrückt wird, so wird die Uhr genau auf diesen Anfangswert gestellt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// rtc.adjust(DateTime(2023, 6, 25, 11, 59, 0));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  ...
</span></span></code></pre></div><p>Wenn am weiteren Code nichts mehr verändert werden soll, kann dieser nun einfach auf den ESP geladen werden.
Dazu klickt ihr in eurer Arduino IDE auf den Pfeil im oberen linken Eck.
Wenn alles richtig gemacht wurde, wird euer Code nun hochgeladen und ihr könnt euer Programm testen.</p><h4 id=7-das-programm>7. Das Programm</h4><p>Um den Code ein wenig verständlicher zu machen, werden anbei noch einige wichtige Parts erklärt</p><h4 id=71-pins-und-hardware-definieren>7.1 PINS und Hardware definieren</h4><p>Zunächst müssen PINS und Hardware definiert werden. Falls ihr eine andere Verkabelung verwenden wollt, so müssen die Pins entsprechend im Code angepasst werden.</p><p>Für die LED-Matrizen gibt es 4 gängige Hardwaretypen: PAROLA_HW, GENERIC_HW, ICSTATION_HW und FC16_HW. In meinem Fall war das FC16_HW.
Falls eure Matrizen den Text komisch oder falschrum anzeigen, versucht zunächst einen anderen Hardwaretyp.
MAX_DEVICES definiert , wie viele 8x8 LED-Matrizen sich in einer Reihe befinden.
NUM_LEDS definiert die Anzahl der LEDs von eurem LED-Stripe, LED_TYPE den Typen des LED-Stripes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// LED Stripe
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#define DATA_PIN    D3
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define LED_TYPE    WS2812
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define COLOR_ORDER GRB
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define NUM_LEDS    145  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Matrizes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#define HARDWARE_TYPE MD_MAX72XX::FC16_HW
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define MAX_DEVICES 6
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// matrix1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#define M1_CLK_PIN   D5
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define M1_CS_PIN    D6
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define M1_DATA_PIN  D7
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// matrix2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#define M2_CLK_PIN   TX 
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define M2_CS_PIN    D4 
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define M2_DATA_PIN  D0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Buttons 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#define BUTTON_PIN  D8
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ANALOG_PIN  A0
</span></span></span></code></pre></div><h4 id=72-rtc-modul-und-led-stripe>7.2 RTC-Modul und LED-Stripe</h4><p>Um auf die Uhrzeit zuzugreifen und die LED&rsquo;s entsprechend zu schalten, muss die Uhrzeit zunächst vom RTC Modul ausgelesen werden.
Die Methode &ldquo;showTime()&rdquo; holt Datum und Uhrzeit vom RTC-Modul und checkt anschließend, welche LED&rsquo;s zur jeweiligen Zeit ein- und ausgeschaltet werden sollen.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// zeigt die aktuelle Uhrzeit an
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>showTime</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Datum und Uhrzeit von RTC Modul auslesen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  DateTime jetzt <span style=color:#f92672>=</span> rtc.now();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> Jahr <span style=color:#f92672>=</span> jetzt.year();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> Monat <span style=color:#f92672>=</span> jetzt.month();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> Tag <span style=color:#f92672>=</span> jetzt.day();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> Stunde <span style=color:#f92672>=</span> jetzt.hour();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> Minute <span style=color:#f92672>=</span> jetzt.minute();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> Sekunde <span style=color:#f92672>=</span> jetzt.second();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> Wochentag <span style=color:#f92672>=</span> jetzt.dayOfTheWeek();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>float</span> Temperatur <span style=color:#f92672>=</span> rtc.getTemperature();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// in das passende 12 Stunden Format bringen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span>(Stunde <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      Stunde <span style=color:#f92672>-=</span> <span style=color:#ae81ff>12</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>25</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      Stunde<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Stunde <span style=color:#f92672>==</span> <span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      Stunde <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// &#34;Es ist&#34; ausgeben
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    leds[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>    leds[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>    leds[<span style=color:#ae81ff>4</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>    leds[<span style=color:#ae81ff>5</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>    leds[<span style=color:#ae81ff>6</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// &#34;Uhr&#34; anzeigen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    Serial.print(<span style=color:#e6db74>&#34;UHR &#34;</span>);
</span></span><span style=display:flex><span>    leds[<span style=color:#ae81ff>133</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>    leds[<span style=color:#ae81ff>134</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>    leds[<span style=color:#ae81ff>135</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Wochentag anzeigen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  Serial.print(<span style=color:#e6db74>&#34;Wochentag: &#34;</span>);
</span></span><span style=display:flex><span>  Serial.print(Wochentag);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>switch</span> (Wochentag) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Montag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>8</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>9</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Dienstag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>10</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>11</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Mittwoch
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>22</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>23</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Donnerstag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>20</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>21</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Freitag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>18</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>19</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Samstag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>6</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>16</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>17</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Sonntag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>14</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>15</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      Serial.println(<span style=color:#e6db74>&#34;Ungültiger Wochentag&#34;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Stunde anzeigen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>switch</span>(Stunde) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Zwölf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ZWÖLF &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>127</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>128</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>129</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>130</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>131</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//EIN(S)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;EIN&#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>93</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>94</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>95</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// sobald es 5 nach 1 ist muss das s mitleuchten
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>4</span>){
</span></span><span style=display:flex><span>        leds[<span style=color:#ae81ff>92</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Zwei
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ZWEI &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>85</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>86</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>87</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>88</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Drei
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;DREI &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>97</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>98</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>99</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>100</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Vier
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VIER &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>104</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>105</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>106</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>107</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Fünf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;FÜNF &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>80</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>81</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>82</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>83</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>6</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Sechs
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;SECHS &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>115</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>116</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>117</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>118</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>119</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>7</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Sieben
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;SIEBEN &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>121</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>122</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>123</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>124</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>125</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>126</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>8</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Acht
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ACHT &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>109</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>110</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>111</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>112</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>9</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Neun
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;NEUN &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>137</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>138</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>139</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>140</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>10</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Zehn
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ZEHN &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>140</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>141</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>142</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>143</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>11</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//Elf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ELF &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>78</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>79</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>80</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Minuten anzeigen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Fünf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;FÜNF &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>27</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>28</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>29</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>30</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Nach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;NACH &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>61</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>62</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>63</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Zehn
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ZEHN &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>44</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>45</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>46</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>47</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Nach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;NACH &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>61</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>62</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>63</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>15</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Viertel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VIERTEL &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>53</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>54</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>55</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>56</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>57</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>58</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>59</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Nach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;NACH &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>61</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>62</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>63</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>20</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>25</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Zwanzig
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ZWANZIG &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>37</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>38</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>39</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>40</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>41</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>42</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>43</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Nach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;NACH &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>61</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>62</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>63</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>25</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Fünf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;FÜNF &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>27</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>28</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>29</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>30</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Vor
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VOR &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>69</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>70</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>71</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Halb
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;HALB &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>73</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>74</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>75</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>76</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>30</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>35</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Halb
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;HALB &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>73</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>74</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>75</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>76</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>35</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>40</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Fünf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;FÜNF &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>27</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>28</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>29</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>30</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Nach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;NACH &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>61</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>62</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>63</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Halb
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;HALB &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>73</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>74</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>75</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>76</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>40</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>45</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Zwanzig
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ZWANZIG &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>37</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>38</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>39</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>40</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>41</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>42</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>43</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Vor
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VOR &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>69</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>70</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>71</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>45</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Viertel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VIERTEL &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>53</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>54</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>55</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>56</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>57</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>58</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>59</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Vor
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VOR &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>69</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>70</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>71</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>50</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>55</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Zehn
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;ZEHN &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>44</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>45</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>46</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>47</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Vor
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VOR &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>69</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>70</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>71</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(Minute <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>55</span> <span style=color:#f92672>&amp;&amp;</span> Minute <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>60</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Fünf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;FÜNF &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>27</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>28</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>29</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>30</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Vor
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      Serial.print(<span style=color:#e6db74>&#34;VOR &#34;</span>);
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>69</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>70</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>      leds[<span style=color:#ae81ff>71</span>] <span style=color:#f92672>=</span> color;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  FastLED.show();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=73-kalenderdaten>7.3 Kalenderdaten</h4><p>Die Kalenderdaten werden mit Hilfe eines <a href=https://github.com/ManuelaDragic/swh/blob/main/code/Kalender.gs download>GoogleSkripts</a> ausgelesen und als String gespeichert.
Da die LED-Matrizen keine Umlaute anzeigen können, werden diese hier noch vorher herausgefiltert. Zusätzlich wird der String in Großbuchstaben umgewandelt. Durch anschließendes Bereitstellen einer WebApp können die Kalenderdaten dann mit einem einfachen HTTP-Request abgefragt werden.
Beim Einschalten der Uhr werden die Daten das Erste mal abgefragt. Der empfangene String wird dann in Substrings unterteilt und anschließend auf den LED-Matrizen angezeigt.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>getKalenderData</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// HTTP-Anfrage senden
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  WiFiClientSecure client;
</span></span><span style=display:flex><span>  HTTPClient http;
</span></span><span style=display:flex><span>  client.setInsecure();
</span></span><span style=display:flex><span>  client.connect(<span style=color:#e6db74>&#34;script.googleusercontent.com&#34;</span>, <span style=color:#ae81ff>443</span>);
</span></span><span style=display:flex><span>  String url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;YOUR_URL&#34;</span>;
</span></span><span style=display:flex><span>  http.setTimeout(<span style=color:#ae81ff>20000</span>);
</span></span><span style=display:flex><span>  http.setFollowRedirects(HTTPC_STRICT_FOLLOW_REDIRECTS);
</span></span><span style=display:flex><span>  http.begin(client, url); 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> httpCode <span style=color:#f92672>=</span> http.GET();
</span></span><span style=display:flex><span>  Serial.println(httpCode);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Daten in payload String speichern
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (httpCode <span style=color:#f92672>==</span> <span style=color:#ae81ff>200</span>) {
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;Getting calendar&#34;</span>);
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> http.getString();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// String in Substrings splitten
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>while</span> (payload.length() <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// an jeder Zeile trennen und als Substring speichern
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>int</span> index <span style=color:#f92672>=</span> payload.indexOf(<span style=color:#e6db74>&#39;\n&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (index <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) 
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      strs[StringCount] <span style=color:#f92672>=</span> payload;
</span></span><span style=display:flex><span>      strs[StringCount].toUpperCase();
</span></span><span style=display:flex><span>      strs[StringCount].toCharArray(events[StringCount], <span style=color:#ae81ff>60</span>);
</span></span><span style=display:flex><span>      Serial.println(strs[StringCount]);
</span></span><span style=display:flex><span>      Serial.println(events[StringCount]);
</span></span><span style=display:flex><span>      StringCount<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      strs[StringCount] <span style=color:#f92672>=</span> payload.substring(<span style=color:#ae81ff>0</span>, index);
</span></span><span style=display:flex><span>      strs[StringCount].toUpperCase();
</span></span><span style=display:flex><span>      strs[StringCount].toCharArray(events[StringCount], <span style=color:#ae81ff>60</span>);
</span></span><span style=display:flex><span>      Serial.println(strs[StringCount]);
</span></span><span style=display:flex><span>      Serial.println(events[StringCount]);
</span></span><span style=display:flex><span>      StringCount<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>      payload <span style=color:#f92672>=</span> payload.substring(index<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  http.end();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Um immer aktuelle Kalenderdaten angezeigt zu bekommen, werden im Loop zwei Uhrzeiten gecheckt, zu denen die Daten aktualisiert werden.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>loop() {
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Kalenderdaten um 2 und 12 Uhr aktualisieren
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (now.hour() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> now.minute() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> now.second() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> now.hour() <span style=color:#f92672>==</span> <span style=color:#ae81ff>12</span> <span style=color:#f92672>&amp;&amp;</span> now.minute() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> now.second() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        getKalenderData();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=74-led-matrizen>7.4 LED-Matrizen</h4><p>Die Kalenderdaten werden als Lauftext auf den LED-Matrizen angezeigt.
Dabei wird der erste Termin auf der ersten Matrix angezeigt, der zweite auf der zweiten Matrix. Anschließend wechselt der zweite Termin auf die erste Matrix und der nächste Termin erscheint auf der zweiten Matrix.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>runMatrix</span>() {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Display Text anzeigen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  matrix1.setIntensity(brightnessMatrix); 
</span></span><span style=display:flex><span>  matrix2.setIntensity(brightnessMatrix);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Wenn matrix1 fertig auf true setzen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (matrix1.displayAnimate()) {
</span></span><span style=display:flex><span>    matrix1Fertig <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Wenn matrix2 fertig auf true setzen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (matrix2.displayAnimate()) {
</span></span><span style=display:flex><span>    matrix2Fertig <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Wenn beide fertig sind, neuen Text anzeigen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (matrix1Fertig <span style=color:#f92672>&amp;&amp;</span> matrix2Fertig) {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// (Zum anpassen: erster Wert: Text, zweiter Wert = Start Position, Dritter Wert = Geschwindigkeit, Vierter Wert = Pause am Ende, Fünfter Wert = Animation Rein, Sechster Wert = Animation Raus)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// Positionen: PA_LEFT, PA_RIGHT, PA_CENTER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// Animationsliste: PA_PRINT, PA_SCROLL_UP, PA_SCROLL_DOWN, PA_SCROLL_LEFT, PA_SCROLL_RIGHT, PA_SCROLL_UP_LEFT, PA_SCROLL_UP_RIGHT, PA_SCROLL_DOWN_LEFT, PA_SCROLL_DOWN_RIGHT,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//                  PA_SPRITE, PA_SLICE, PA_MESH, PA_FADE, PA_DISSOLVE, PA_BLINDS, PA_RANDOM, PA_WIPE, PA_WIPE_CURSOR, 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//                  PA_SCAN_HORIZ, PA_SCAN_HORIZX, PA_SCAN_VERT, PA_SCAN_VERTX, PA_OPENING, PA_OPENING_CURSOR, PA_CLOSING, PA_CLOSING_CURSOR, PA_GROW_UP, PA_GROW_DOWN 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    matrix1.displayText (events[i], PA_LEFT, speed, <span style=color:#ae81ff>0</span>, PA_SCROLL_LEFT, PA_SCROLL_LEFT);
</span></span><span style=display:flex><span>    <span style=color:#75715e>//  set up for next text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    i<span style=color:#f92672>++</span>; 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>==</span> StringCount) {
</span></span><span style=display:flex><span>      i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    matrix2.displayText (events[i], PA_LEFT, speed, <span style=color:#ae81ff>0</span>, PA_SCROLL_LEFT, PA_SCROLL_LEFT);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>    matrix1Fertig <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>    matrix2Fertig <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    delay (<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>&ldquo;displayAnimate()&rdquo; startet die Animation des Lauftextes und gibt true zurück, wenn diese durchgelaufen ist.
Erst wenn beide Matrizen durchgelaufen sind werden dann neue Daten angezeigt.
&ldquo;displayText()&rdquo; zeigt den Text mit einer Startposition, einer Geschwindigkeit, einem Delay und einer ein- und auslauf Animation an.
Die Animationen können beliebig geändert werden. Eine Liste von Animationen ist im Kommentar gegeben.</p><h4 id=75-buttons-und-helligkeitssensor>7.5 Buttons und Helligkeitssensor</h4><p>Die Buttons und der Helligkeitssensor werden kontinuierlich im loop überprüft. Der Farbwechsel Button ist an einem digitalen Pin angeschlossen und wird mit einem Debouncer entprellt, sodass bei einem Klick auch nur einmal reagiert wird.
Die anderen beiden Buttons und der Helligkeitssensor befinden sich an einem analogen Pin.
Mit &ldquo;analogRead()&rdquo; wird des Wert des analogen PIN&rsquo;s ständig überprüft. Durch Veränderung des Wertes werden dann z.B. ein Knopfdruck oder eine Änderung der Helligkeit registriert.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>loop</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ------ Farbwechsel Button ------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  debouncer.update();       <span style=color:#75715e>// Entprellten Wert aktualisieren
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (debouncer.rose()) {
</span></span><span style=display:flex><span>    changeColor();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ------ Helligkeit anpassen ------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Helligkeit herabsetzen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (analogRead(ANALOG_PIN) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>300</span>) {
</span></span><span style=display:flex><span>    brightnessDown <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Helligkeit erhöhen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (analogRead(ANALOG_PIN) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>500</span> <span style=color:#f92672>&amp;&amp;</span> analogRead(ANALOG_PIN) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>300</span>) {
</span></span><span style=display:flex><span>    brightnessDown <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ------ Matrizen Button ------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// AN/AUS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span>(buttonMatrizenStatus) {
</span></span><span style=display:flex><span>    runMatrix();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>matrizenStatus) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (analogRead(ANALOG_PIN) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1000</span>) {
</span></span><span style=display:flex><span>      buttonMatrizenStatus <span style=color:#f92672>=</span> <span style=color:#f92672>!</span>buttonMatrizenStatus;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>buttonMatrizenStatus) {
</span></span><span style=display:flex><span>        matrix1.displayClear();
</span></span><span style=display:flex><span>        matrix2.displayClear();
</span></span><span style=display:flex><span>        matrix1.displayReset();
</span></span><span style=display:flex><span>        matrix2.displayReset();
</span></span><span style=display:flex><span>        i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      matrizenStatus <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>      matrizenTimer <span style=color:#f92672>=</span> millis();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ------ Backlight Button ------
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// AN/AUS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (analogRead(ANALOG_PIN) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>600</span>) {
</span></span><span style=display:flex><span>      buttonBacklightOff <span style=color:#f92672>=</span> <span style=color:#f92672>!</span>buttonBacklightOff;
</span></span><span style=display:flex><span>      matrizenStatus <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>      matrizenTimer <span style=color:#f92672>=</span> millis();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  } 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// nur auf einen Druck reagieren
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(analogRead(ANALOG_PIN) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>500</span> <span style=color:#f92672>&amp;&amp;</span> ((millis() <span style=color:#f92672>-</span> matrizenTimer) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>500</span>)) {
</span></span><span style=display:flex><span>      matrizenStatus <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=8-löten>8. Löten</h4><p>Wenn das uploaden geklappt hat und alle Kompononten funktioniern, könnt ihr nun mit dem Löten beginnen.
Nehmt nochmal den Lötplan zur Hand und lötet die Kabel nach und nach an eure Komponenten.</p><p>ACHTUNG! Achtet darauf, dass ihr vor dem Löten den Strom abzieht und die Batterie des RTC-Moduls entnehmt.</p><p>Für den ESP und das RTC Modul habe ich die 6x8cm große Platine verwendet. Lötet das RTC Modul so an, dass die Batterie nach oben zeigt. So könnt ihr diese später austauschen, falls sie leer gehen sollte.
Für die Buttons habe ich je eine der drei 2x8cm Platinen verwendet.
Damit die Buttons später in die Aussparungen im Rahmen passen, müsst ihr jetzt noch beachten, dass ihr die Buttons und den Helligkeitssensor an die richtige Stelle der Platine lötet. (Die Buttons werden jeweils in das untere Eck der Platine platziert).
Außerdem muss beachtet werden, dass alle Kabel die richtige Länge besitzen.
Legt die Teile am besten vorher in euren Rahmen und testet, wie lang die Kabel ca. sein müssen.
Der ON/OFF-Kippschalter wird erst nach zusammenbauen der Uhr angelötet, da dieser von Außen auf den Rahmen gesteckt werden muss.</p><p>Überprüft vor dem Anschließen des Stroms nochmal alle Lötstellen und achtet darauf, dass ihr keinen Kurzschluss verursacht habt, indem ihr aus Versehen Lötstellen verbunden habt.</p><h4 id=9-zusammenbau>9. Zusammenbau</h4><p>Zu Schluss muss das Projekt dann noch zusammengebaut werden.
Dazu setzt ihr zunächst die Matrizenhalterung in den Rahmen ein. In die Matrizenhalterung werden dann die LED-Matrizen geseteckt. Die Kabel führt ihr nach oben durch die Lücke in das Innere des Rahmens. Die Technik befindet sich so hinter der zuvor gebauten Buchstabenplatte. Setzt die Platinen nach folgendem Plan vorsichtig in die jeweiligen Halterungen ein.</p><figure><img src=../pictures/aufbau.jpg width=100% height=80%></figure><p>Der Helligkeitssensor sollte dabei etwas aus dem Rahmen herausschauen, sodass er die Helligkeit auch richtig messen kann.
Die Platinen der Buttons klebt ihr dann mit 2 Komponenten Kleber in die jeweiligen Lücken im Rahmen.
Anschließend klebt ihr die Buchstabenplatte mit doppelseitigem Klebeband in den Rahmen der Uhr. Wenn alles passt, sollten Rahmen, Matrizen und Buchstabenplatte nun bündig abschließen und somit eine ebene Fläche bilden.</p><p>Wenn alles passt könnt ihr dann mit einem Lötkolben die 4 Schraubenfassungen in die Löcher auf der Rückseite des Rahmens drücken.
Als Letztes kann dann die durchsichtige Rückplatte mit dem Rahmen verschraubt werden.</p><p>Zu guter Letzt kann dann noch das Furnier auf die Vorderseite der Uhr geklebt werden - Und fertig ist der selbstgebaute WordClockanizer.</p><p><figure><img src=../pictures/schritt1.jpeg width=60% height=60%></figure><figure><img src=../pictures/schritt2.jpeg width=60% height=60%></figure><figure><img src=../pictures/schritt3.jpeg width=60% height=60%></figure><figure><img src=../pictures/schritt4.jpeg width=60% height=60%></figure><figure><img src=../pictures/schritt5.jpeg width=60% height=60%></figure><figure><img src=../pictures/clock.jpeg width=60% height=60%></figure></p><h3 id=lizensierung>Lizensierung</h3><p><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons Lizenzvertrag" style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/88x31.png></a><br>Dieses Werk ist lizenziert unter einer <a rel=license href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Namensnennung 4.0 International Lizenz</a>.</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-near-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://manueladragic.github.io/swh/>&copy; Sketching with Hardware I + II 2023</a><div><div class=ananke-socials></div></div></div></footer></body></html>